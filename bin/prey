#!/bin/sh
dir="$(dirname $0)"

# if current file is a symlink (e.g. installed via npm) we'll append 
# the relative path to where the package is actually installed.
if [ -n "$(readlink $0)" ]; then
  rel="$(dirname $(readlink $0))"
  dir="$dir/$rel"
fi

script="lib/agent/cli.js"
if [ "$1" = "config" ]; then
  script="lib/conf/cli.js"
elif [ "$1" = "test" ]; then
  script="node_modules/.bin/_mocha"
fi

if [ -x "$dir/node" ]; then
  exec "$dir/node" "$dir/../${script}" "$@"
else
  exec node "$dir/../${script}" "$@"
fi