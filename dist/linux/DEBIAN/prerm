#!/bin/bash
####################################################################
# Prey Debian Preremove Script - by Tomas Pollak (bootlog.org)
# URL : http://preyproject.com
# License: GPLv3
####################################################################

set -e

PREY_USER='prey'
INSTALL_PATH="/usr/lib/prey"
PREY_BIN="bin/prey"

if [ -d "${INSTALL_PATH}/current" ]; then
  INSTALL_PATH="${INSTALL_PATH}/current"
fi

case "$1" in
  remove|remove-in-favour|deconfigure|deconfigure-in-favour)
    cd "$INSTALL_PATH"
    [ -f "$PREY_BIN" ] && $PREY_BIN config hooks pre_uninstall > /dev/null
    [ -f "$PREY_BIN" ] && su $PREY_USER -c "$PREY_BIN config deactivate" > /dev/null
    ;;

  upgrade|failed-upgrade)
    ;;

  *)
    echo "prerm called with unknown argument \`$1'" >&2
    exit 1
    ;;
esac

exit 0
